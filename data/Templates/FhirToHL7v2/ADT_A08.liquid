{% comment %} {{ '' | debug }} {% endcomment %}
{%- assign messageHeaderObject = fhirData.entry | select: 'resource.resourceType', 'MessageHeader' | get_index: 0 -%}
{% comment %} Since this is the ADT_08 liquid template, the following 3 can be hardcoded {% endcomment %}
{%- assign messageCodeMSH = 'ADT' -%}
{%- assign triggerEventMSH = 'A08' -%}
{%- assign messageStructureMSH = 'ADT_A08' -%}
{%- assign patient = fhirData.entry | get_resource: 'Patient' -%}
{%- assign patientAccount = fhirData.entry | get_resource: 'Account' -%}
{%- assign patientOrganizations = fhirData.entry | select: 'resource.resourceType', 'Organization' -%}
{%- assign patientRelatedPersons = fhirData.entry | select: 'resource.resourceType', 'RelatedPerson' -%}
{%- if patient.identifier and patient.identifier.size > 1 -%}
    {%- assign patientMRalt = patient.identifier[1] -%}
{%- endif -%}
{%- comment %} patient: {{ patient.id }} {% endcomment -%}
{%- comment %} extension: {{ patient.extension }} {% endcomment -%}
{%- comment %} Message Header          {% endcomment -%}{%- include 'Segments/MSH' messageTime: fhirData.timestamp, messageID: fhirData.identifier.value, messageHeader: messageHeaderObject, messageCode: messageCodeMSH, triggerEvent: triggerEventMSH, messageStructure: messageStructureMSH %}
{%- comment %} Software Segment        {% endcomment -%}{%- comment %}SFT|Orion|2.4.3.52854|Rhapsody|2.4.3|Testactivity|20070725111624{% endcomment -%}
{%- comment %} Event Type              {% endcomment -%}{%- include 'Segments/EVN' recordedTime: fhirData.timestamp %}
{%- comment %} Patient Identification  {% endcomment -%}{%- include 'Segments/PID' patient: patient, patientMR: patient.identifier[0], patientMRalt: patientMRalt, patientOrganizations: patientOrganizations, patientRelatedPersons: patientRelatedPersons %}
{%- comment %} Patient Additional Demo {% endcomment -%}{%- comment %}PD1|S^^ACR||LINDAS TEST ORGANIZATION^^SIISCLIENT818|88^Hippo^rold^H^V^Dr^MD^^TE^^^M10^DN^^||||||||||Methodist Church|||20150202^20150202{% endcomment -%}
{%- comment %} Next of Kin             {% endcomment -%}{%- comment %}NK1|1|Evan&&&&Aniston^ADAM^A^III^Dr.^MD^D|EMC^test^ACR^CHD^^^9.0^10.0|2222&HOME&STREET^Highway^GREENSBORO^NC^27401-1020^US^BI^^jkdha&test^^^^20000110^20050111~111&Duck ST^^Fowl|78788788^WPN^Internet^5555^^^^^^^^^20010110^20020110^^^^18~121111^PRN^CP|88888888^PRN^CP^5555^^^^^^^^878777^20010110^20020110^^^^18~6666666^^BP|O|20210818|20211218|||12345567^4^M11^T1&2.16.840.1.113883.19&HCD^MR^University Hospital^19241011^19241012|TestOrg^^O12^^^^EI^^^Org12||F^^^M|19620110045504||||ara||||||||||Green^John^A^II^DR^MD^D^^^19241012^G~Josh&&&&Bing^^stanley^^^^L|898989898^^FX~88888888^^CP|Street1&Palkstreet~ST-2|I-123^^^^BA~I-222^^^^DI||2106-3^test^FDDC||Security no-23|||1515151515^WPN^CP^555544^^^^^^^^777^20010110^20020110^^^^1|444444^^CP{% endcomment -%}
{%- comment %} Patient Visit           {% endcomment -%}{%- include 'Segments/PV1' setID: 1, patientClass: 'P' %}
{%- comment %} Patient Visit Addit     {% endcomment -%}{%- comment %}PV2|^ROOM1&2.16.840.1.113883.4.642.1.1108&ISO^BED1^FACILITY1^^^BUILDING1^FLOOR1^^^||140004^Chronic pharyngitis^SCT||||||||2|Health Checkup|12188^Hippocrates^Harold^H^IV^Dr^MD^^TE&Provider Master.Community Health and Hospitals&DNS^^^M10^DN^^|||||||||N|||2^^^3^^^V1.2^V1.3|||||||||||||C{% endcomment -%}
{%- comment %} Disability              {% endcomment -%}{%- comment %}DB1|1|PT|DB123^4^M11^t&1.12&ISO^MR^UH^19241011^19241012|Y|20210830|20210930|{% endcomment -%}
{%- comment %} Observation / Result    {% endcomment -%}{%- comment %}OBX|27|NM|8867-4^heartrate^LN||60~120|beats/min^^ISO|70-80|A^A^HL7nnnn~B^B|||S|||19990702|Org15^ID of producer^CAS|1134^Aly^Zafar^Mahendra^JR^Dr.^MD^^PERSt&1.23&HCD^B^^^BR^^^^^^19241010^19241015^Al~2234^Pauly^Berrie^Raud|OBS^This is test method^AS4|EI12.3^NI2^UI2^GUID~^^UI1^ISO|19990702|BU^Observation site^E5|EI21^OII||FairOaks Hspital|Research Park^Fairfax^VA^22031^USA|MD-25^Atchinson^Christopher^^MD|||||||PAI-1^FAI-1{% endcomment -%}
{%- comment %} Patient Allergy Info    {% endcomment -%}{%- comment %}AL1|1|EA|P^PENICILLIN^ICDO|MI|CODE16|20210824{% endcomment -%}
{%- comment %} Diagnosis               {% endcomment -%}{%- comment %}DG1|1|I9|422504002^Ischemic stroke(disorder)^SCT|Stroke|20040125114025+0420|A|||||||||1|005454^DIAG^ROBIN^B|||20200501133015+0215|DI20^Diagnosis^DTUI^CLIP|A|^^UI^CLIP{% endcomment -%}
{%- comment %} Procedures              {% endcomment -%}{%- comment %}PR1|1||76164006^Biopsy of colon (procedure)^SCT|Biopsy of colon, which was part of colonoscopy|200501251140+0100|D^Diagnostic Procedure^HL70230|2|1210^ANES^MARK^B|||121188^Patrick^Harold^H^IV^Dr^MD^^&Provider Master.Community Health and Hospitals&L^L^9^M10^DN^&Good Health Hospital.Community Health and Hospitals&L^A|12345689^Everyman2^Adam2^A^III^DR^PHD^ADT01^^L^4^M11^MR|||799008^Sigmoid colon ulcer^SCT||||PR1006||||OT^201||PR1001{% endcomment -%}
{%- comment %} Guarantor               {% endcomment -%}{%- comment %}GT1|1|1516^4^M11^test^MR^Unity Hospital^19241011^19241012|RADIANT^LUCY^^|Rebecca^Jonas|1619 SOUTH UNIVERSITY^^MADISON^WI^53703^US|6082517777^^Internet^8484~717171^^PH|021212^^MD|20010412|F|P/F|SEL|G-SSN-12|20010410|20010415|2|EHS GENERIC EMPLOYER|1979 MILKY WAY^^VERONA^WI^53593^US|082719000^^PH|55121^^^^FI|3|Jupiter Hospital|N|SLF|20000725111420|N||||1231^^^^BC|M|20091010|20101010||||ger||||||MothersMaiden|||Ben^Charles~Ben2|000352^^CP~00121^^FX|Urgent requirement||||GEOrg|||||Germany{% endcomment -%}
{%- comment %} Insurance               {% endcomment -%}{%- comment %}IN1|1|BAV^Blue Advantage HMO|IC-1.31^24^BCV^&2.16.840.1.113883.1.1&ISO^NIIP^^19291011^19291012|Blue Cross Blue Shield of Texas|1979 MILKY WAY^^VERONA^WI^53593^US|Henry&&&&Roth^Rony^A^III^Dr.^MD^D^^^19251012|(555)555-5555^BPN^PH|PUBSUMB|SelfPay||Sam P. Hil|19891001|20501001||HMO^health maintenance organization policy|Doe^Rosallie^John^III^Mrs.^Bachelors^R|SPO^Spouse|19750228|3857 Velvet Treasure Terrace^^Midnight^NC^27878^US|||||||||||||||||PN-145|150&USD^DC||||||F^Female|2000 MILKY WAY^^VERONA^WI^53593^US|||B||HMO-12345^^^&2.16.840.1.113883.1.3&ISO^NI{% endcomment -%}
{%- comment %} Insurance Addit Info    {% endcomment -%}{%- comment %}IN2|1117^4^M11^&2.16.840.1.113883.1.4&ISO^EI^University Hospital~1118^^^^BC|425-57-9745|||I^Insurance company|Medicare-12345|Jack&&&&Aniston^ADAM^A^III^Dr.^MD^D^^^19241012^^^^PF^Addsm|MCN-008||MI-12345||||||||||||||||||||||||eng^English|||||||||||||||Richard^Paul|254622222^^PH|||||||||||PNM1234^4^M11^PM&2.6.1&HCD^MR^University Hospital^19241011^19241012||0005245^WPN^Internet~^^CP|555777888^^FX~^^PH||||||Max Life Insurance||02^Spouse{% endcomment -%}
{%- comment %} Referral Info           {% endcomment -%}{%- comment %}RF1|P^Pending^HL7283|A^ASAP^HL7280|EXTERNAL|||123-1^name|||19900501120100+0515|R-1^Reason^C4|123-2^Testname|||Patient has a spinal fracture|||||AuthProvider^L^4.4^3^M10^CMS^LR^^^A|114^Beverly^Crusher^An^Mr^Dr.^AHP^^2.3^B^^^BR^^^^^^19241010^19241015^Al||||Check for metastatic disease|U{% endcomment -%}
